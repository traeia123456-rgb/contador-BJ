<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="description" content="Contador Cartas BJ" />
		<meta name="keywords" content="Contador, Cartas, BJ" />
		<meta name="author" content="INFOSYSTEM" />
		<meta name="robots" content="index, follow" />
		<meta name="language" content="es" />
		<meta name="copyright" content="INFOSYSTEM" />
		<meta name="google-site-verification" content="google-site-verification" />
		<meta name="googlebot" content="index, follow" />
		<meta name="bingbot" content="index, follow" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="yandexbot" content="index, follow" />
		<title>Contador Cartas BJ</title>
	</head>
	<body>
		<slot />

		<!-- Botón de guardado global visible para todos los usuarios -->
		<button id="global-save" title="Guardar cambios"
		  class="fixed bottom-4 right-4 z-50 px-4 py-2 rounded-md border border-white/20 bg-white/10 hover:bg-white/20 text-white shadow">
		  Guardar
		</button>
		<div id="global-save-toast" class="fixed bottom-20 right-4 hidden px-3 py-2 rounded-md bg-black/70 text-white text-sm shadow"></div>

		<script>
			// Gestor GlobalSave disponible en todo el sitio
			;(function(){
				type GlobalSaveCallback = () => void | Promise<void>;
				const registry: Set<GlobalSaveCallback> = new Set();
				const toast = document.getElementById('global-save-toast');
				function showToast(msg) {
					if(!toast) return;
					toast.textContent = msg;
					toast.classList.remove('hidden');
					setTimeout(()=>toast.classList.add('hidden'), 1500);
				}
				(window).GlobalSave = {
					register(fn){ registry.add(fn); return fn; },
					unregister(fn){ registry.delete(fn); },
					async saveAll(){
						showToast('Guardando…');
						for (const fn of Array.from(registry)) {
							try { await fn(); } catch(e){ console.warn('GlobalSave callback error:', e); }
						}
						showToast('Cambios guardados');
					}
				};
				document.getElementById('global-save')?.addEventListener('click', ()=>{
					(window).GlobalSave.saveAll();
				});
			})();
		</script>

	</body>
</html>

<style is:global>
	@import "tailwindcss";
	@plugin "@midudev/tailwind-animations";
	@theme {
		--color-bj-green: #0b8f2a;
		--color-bj-black: #0a0a0a;
		--color-bj-white: #ffffff;
		--color-bj-gray: #6b7280;
	}
	html,
	body {
		margin: 0;
		width: 100%;
		height: 100%;
	}
	body {
		background-image: linear-gradient(to bottom right, var(--color-bj-green), var(--color-bj-black));
		color: var(--color-bj-white);
	}
</style>
